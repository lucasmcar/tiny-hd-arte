function initializeEvents(){var e=document.getElementById("addPartnerBtn");let d=document.getElementById("addPartnerModal");var t=document.getElementById("closeAddModal");let c=document.getElementById("addPartnerForm"),s=document.querySelector(".parceiros-table"),m=document.querySelector('input[name="_csrf_token"]')?.value;m?(e&&d&&t&&c?(e.addEventListener("click",function(){d.classList.add("active"),document.querySelector("#addPartnerModal .modal-header h3").textContent="Adicionar Novo Parceiro",c.reset(),d.removeAttribute("data-edit-id")}),t.addEventListener("click",function(){d.classList.remove("active")}),d.addEventListener("click",function(e){e.target===d&&d.classList.remove("active")}),c.addEventListener("submit",function(e){e.preventDefault();let n=d.hasAttribute("data-edit-id"),i=d.getAttribute("data-edit-id"),o={tiktok:document.getElementById("partnerTiktok").value.trim(),linkedin:document.getElementById("partnerLinkedin").value.trim(),instagram:document.getElementById("partnerInstagram").value.trim(),facebook:document.getElementById("partnerFacebook").value.trim()},l={nome:document.getElementById("partnerName").value.trim(),tipo:document.getElementById("partnerType").value,email:document.getElementById("partnerEmail").value.trim(),telefone:document.getElementById("partnerPhone").value.trim(),redes_sociais:o,descricao:document.getElementById("partnerDescription").value.trim(),_csrf_token:m};e=n?"/admin/parceiros/update/"+i:"/admin/parceiros/add";n;fetch(e,{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":m,"X-Requested-With":"XMLHttpRequest"},body:JSON.stringify(l)}).then(t=>t.ok?t.json():t.text().then(e=>{throw new Error(`Erro HTTP ${t.status}: `+e)})).then(e=>{var t,a,r;e.success?(r=[],o.tiktok&&r.push(`<a href="${o.tiktok}" target="_blank"><i class="bi bi-tiktok"></i></a>`),o.linkedin&&r.push(`<a href="${o.linkedin}" target="_blank"><i class="bi bi-linkedin"></i></a>`),o.instagram&&r.push(`<a href="${o.instagram}" target="_blank"><i class="bi bi-instagram"></i></a>`),o.facebook&&r.push(`<a href="${o.facebook}" target="_blank"><i class="bi bi-facebook"></i></a>`),r=r.length?r.join(" "):"-",t=l.descricao?50<l.descricao.length?l.descricao.substring(0,50)+"...":l.descricao:"-",n?document.querySelector(`.table-row:has([data-id="${i}"])`).innerHTML=`
                            <div class="table-cell">${l.nome}</div>
                            <div class="table-cell">${l.tipo}</div>
                            <div class="table-cell">${l.email}</div>
                            <div class="table-cell">${l.telefone}</div>
                            <div class="table-cell">${r}</div>
                            <div class="table-cell">${t}</div>
                            <div class="table-cell">
                                <button class="action-btn edit-btn" data-id="${i}"><i class="bi bi-pen"></i></button>
                                <button class="action-btn delete-btn" data-id="${i}"><i class="bi bi-trash"></i></button>
                            </div>
                        `:((a=document.createElement("div")).className="table-row",a.innerHTML=`
                            <div class="table-cell">${l.nome}</div>
                            <div class="table-cell">${l.tipo}</div>
                            <div class="table-cell">${l.email}</div>
                            <div class="table-cell">${l.telefone}</div>
                            <div class="table-cell">${r}</div>
                            <div class="table-cell">${t}</div>
                            <div class="table-cell">
                                <button class="action-btn edit-btn" data-id="${e.id}"><i class="bi bi-pen"></i></button>
                                <button class="action-btn delete-btn" data-id="${e.id}"><i class="bi bi-trash"></i></button>
                            </div>
                        `,s.appendChild(a),(r=document.querySelector(".no-parceiros"))&&r.remove()),alert(n?"Parceiro atualizado com sucesso!":"Parceiro adicionado com sucesso!"),d.classList.remove("active"),c.reset()):alert(e.message||"Erro ao salvar parceiro.")}).catch(e=>{console.error("Erro ao salvar parceiro:",e),alert("Erro ao salvar parceiro: "+e.message)})})):console.error("Erro ao encontrar elementos do modal de adição."),document.addEventListener("click",function(e){var t,a,r,n,i,o;if(e.target.closest(".edit-btn")&&(t=(o=e.target.closest(".edit-btn")).getAttribute("data-id"),l=(o=o.closest(".table-row")).children[0].textContent,a=o.children[1].textContent,r=o.children[2].textContent,n=o.children[3].textContent,i=o.children[4],o="-"===o.children[5].textContent?"":o.children[5].textContent.replace("...",""),document.getElementById("partnerName").value=l,document.getElementById("partnerType").value=a,document.getElementById("partnerEmail").value=r,document.getElementById("partnerPhone").value=n,document.getElementById("partnerTiktok").value=i.querySelector(".bi-tiktok")?.parentElement?.href||"",document.getElementById("partnerLinkedin").value=i.querySelector(".bi-linkedin")?.parentElement?.href||"",document.getElementById("partnerInstagram").value=i.querySelector(".bi-instagram")?.parentElement?.href||"",document.getElementById("partnerFacebook").value=i.querySelector(".bi-facebook")?.parentElement?.href||"",document.getElementById("partnerDescription").value=o,d.classList.add("active"),d.setAttribute("data-edit-id",t),document.querySelector("#addPartnerModal .modal-header h3").textContent="Editar Parceiro"),e.target.closest(".delete-btn")){let a=e.target.closest(".delete-btn");var l=a.getAttribute("data-id");confirm("Tem certeza que deseja excluir este parceiro?")&&fetch("/admin/parceiros/delete/"+l,{method:"DELETE",headers:{"X-CSRF-TOKEN":m,"X-Requested-With":"XMLHttpRequest"}}).then(t=>t.ok?t.json():t.text().then(e=>{throw new Error(`Erro HTTP ${t.status}: `+e)})).then(e=>{var t;e.success?(a.closest(".table-row").remove(),document.querySelectorAll(".table-row").length||((t=document.createElement("div")).className="no-parceiros",t.innerHTML="<p>Nenhum parceiro cadastrado no momento.</p>",s.insertAdjacentElement("afterend",t)),alert("Parceiro excluído com sucesso!")):alert(e.message||"Erro ao excluir parceiro.")}).catch(e=>{console.error("Erro ao excluir parceiro:",e),alert("Erro ao excluir parceiro: "+e.message)})}})):console.error("Token CSRF não encontrado. Verifique o HTML.")}initializeEvents();