function initializeEvents(){console.log("Inicializando eventos...");var e=document.getElementById("addPartnerBtn");let c=document.getElementById("addPartnerModal");var t=document.getElementById("closeAddModal");let d=document.getElementById("addPartnerForm"),s=document.querySelector(".parceiros-table"),m=document.querySelector('input[name="_csrf_token"]')?.value;m?(e&&c&&t&&d?(console.log("Elementos do modal de adição encontrados."),e.addEventListener("click",function(){c.classList.add("active"),document.querySelector("#addPartnerModal .modal-header h3").textContent="Adicionar Novo Parceiro",d.reset(),c.removeAttribute("data-edit-id"),console.log("Modal de adição aberto.")}),t.addEventListener("click",function(){c.classList.remove("active"),console.log("Modal de adição fechado.")}),c.addEventListener("click",function(e){e.target===c&&(c.classList.remove("active"),console.log("Modal fechado ao clicar fora."))}),d.addEventListener("submit",function(e){e.preventDefault();let o=c.hasAttribute("data-edit-id"),n=c.getAttribute("data-edit-id"),i={tiktok:document.getElementById("partnerTiktok").value.trim(),linkedin:document.getElementById("partnerLinkedin").value.trim(),instagram:document.getElementById("partnerInstagram").value.trim(),facebook:document.getElementById("partnerFacebook").value.trim()},l={nome:document.getElementById("partnerName").value.trim(),tipo:document.getElementById("partnerType").value,email:document.getElementById("partnerEmail").value.trim(),telefone:document.getElementById("partnerPhone").value.trim(),redes_sociais:i,descricao:document.getElementById("partnerDescription").value.trim(),_csrf_token:m};e=o?"/admin/parceiros/update/"+n:"/admin/parceiros/add";o;fetch(e,{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":m,"X-Requested-With":"XMLHttpRequest"},body:JSON.stringify(l)}).then(t=>t.ok?t.json():t.text().then(e=>{throw new Error(`Erro HTTP ${t.status}: `+e)})).then(e=>{var t,a,r;e.success?(console.log("Parceiro salvo com sucesso:",e),r=[],i.tiktok&&r.push(`<a href="${i.tiktok}" target="_blank"><i class="bi bi-tiktok"></i></a>`),i.linkedin&&r.push(`<a href="${i.linkedin}" target="_blank"><i class="bi bi-linkedin"></i></a>`),i.instagram&&r.push(`<a href="${i.instagram}" target="_blank"><i class="bi bi-instagram"></i></a>`),i.facebook&&r.push(`<a href="${i.facebook}" target="_blank"><i class="bi bi-facebook"></i></a>`),r=r.length?r.join(" "):"-",t=l.descricao?50<l.descricao.length?l.descricao.substring(0,50)+"...":l.descricao:"-",o?document.querySelector(`.table-row:has([data-id="${n}"])`).innerHTML=`
                            <div class="table-cell">${l.nome}</div>
                            <div class="table-cell">${l.tipo}</div>
                            <div class="table-cell">${l.email}</div>
                            <div class="table-cell">${l.telefone}</div>
                            <div class="table-cell">${r}</div>
                            <div class="table-cell">${t}</div>
                            <div class="table-cell">
                                <button class="action-btn edit-btn" data-id="${n}"><i class="bi bi-pen"></i></button>
                                <button class="action-btn delete-btn" data-id="${n}"><i class="bi bi-trash"></i></button>
                            </div>
                        `:((a=document.createElement("div")).className="table-row",a.innerHTML=`
                            <div class="table-cell">${l.nome}</div>
                            <div class="table-cell">${l.tipo}</div>
                            <div class="table-cell">${l.email}</div>
                            <div class="table-cell">${l.telefone}</div>
                            <div class="table-cell">${r}</div>
                            <div class="table-cell">${t}</div>
                            <div class="table-cell">
                                <button class="action-btn edit-btn" data-id="${e.id}"><i class="bi bi-pen"></i></button>
                                <button class="action-btn delete-btn" data-id="${e.id}"><i class="bi bi-trash"></i></button>
                            </div>
                        `,s.appendChild(a),(r=document.querySelector(".no-parceiros"))&&r.remove()),alert(o?"Parceiro atualizado com sucesso!":"Parceiro adicionado com sucesso!"),c.classList.remove("active"),d.reset()):alert(e.message||"Erro ao salvar parceiro.")}).catch(e=>{console.error("Erro ao salvar parceiro:",e),alert("Erro ao salvar parceiro: "+e.message)})})):console.error("Erro ao encontrar elementos do modal de adição."),document.addEventListener("click",function(e){var t,a,r,o,n,i;if(e.target.closest(".edit-btn")&&(t=(i=e.target.closest(".edit-btn")).getAttribute("data-id"),console.log("Editar parceiro ID:",t),l=(i=i.closest(".table-row")).children[0].textContent,a=i.children[1].textContent,r=i.children[2].textContent,o=i.children[3].textContent,n=i.children[4],i="-"===i.children[5].textContent?"":i.children[5].textContent.replace("...",""),document.getElementById("partnerName").value=l,document.getElementById("partnerType").value=a,document.getElementById("partnerEmail").value=r,document.getElementById("partnerPhone").value=o,document.getElementById("partnerTiktok").value=n.querySelector(".bi-tiktok")?.parentElement?.href||"",document.getElementById("partnerLinkedin").value=n.querySelector(".bi-linkedin")?.parentElement?.href||"",document.getElementById("partnerInstagram").value=n.querySelector(".bi-instagram")?.parentElement?.href||"",document.getElementById("partnerFacebook").value=n.querySelector(".bi-facebook")?.parentElement?.href||"",document.getElementById("partnerDescription").value=i,c.classList.add("active"),c.setAttribute("data-edit-id",t),document.querySelector("#addPartnerModal .modal-header h3").textContent="Editar Parceiro"),e.target.closest(".delete-btn")){let a=e.target.closest(".delete-btn");var l=a.getAttribute("data-id");console.log("Excluir parceiro ID:",l),confirm("Tem certeza que deseja excluir este parceiro?")&&fetch("/admin/parceiros/delete/"+l,{method:"DELETE",headers:{"X-CSRF-TOKEN":m,"X-Requested-With":"XMLHttpRequest"}}).then(t=>t.ok?t.json():t.text().then(e=>{throw new Error(`Erro HTTP ${t.status}: `+e)})).then(e=>{var t;e.success?(a.closest(".table-row").remove(),document.querySelectorAll(".table-row").length||((t=document.createElement("div")).className="no-parceiros",t.innerHTML="<p>Nenhum parceiro cadastrado no momento.</p>",s.insertAdjacentElement("afterend",t)),alert("Parceiro excluído com sucesso!")):alert(e.message||"Erro ao excluir parceiro.")}).catch(e=>{console.error("Erro ao excluir parceiro:",e),alert("Erro ao excluir parceiro: "+e.message)})}})):console.error("Token CSRF não encontrado. Verifique o HTML.")}console.log("Script gerenciar-parceiros.js carregado com sucesso!"),initializeEvents();