function initializeEditalEvents(){var e=document.getElementById("submitUpload");let t=document.getElementById("upload-edital-form"),a=document.getElementById("loading"),n=document.querySelector('input[name="_csrf_token"]')?.value;function o(e){var t=e.target.closest("button");if(t){var a=t.getAttribute("data-id"),o=t.classList.contains("approve-btn")?"aprovado":"reprovado",i=document.querySelector('input[name="_csrf_token"]')?.value;if(a)if(i){let n=document.querySelector(".loading");n&&(n.style.display="block"),fetch("/admin/alterar-status-edital",{method:"PUT",headers:{"Content-Type":"application/json","X-Requested-With":"XMLHttpRequest","X-CSRF-TOKEN":i},body:JSON.stringify({id:a,status:o,_csrf_token:i})}).then(e=>{if(e.ok)return e.json();throw new Error("Erro na requisição: "+e.status)}).then(t=>{n&&(n.style.display="none");var a=document.querySelector(`tr[data-id="${t.id}"]`);if(a){a=a.getElementsByTagName("td");a[0].textContent=t.name,a[1].textContent=t.filename,a[2].textContent=new Date(t.data_upload).toLocaleString("pt-BR"),a[3].textContent=t.status;let e=document.createElement("div");e.className="success-message",e.textContent=t.message,document.querySelector(".edital-table").prepend(e),setTimeout(()=>e.remove(),3e3)}else console.warn("Linha não encontrada para o edital:",t.id)}).catch(e=>{console.error("Erro ao atualizar status:",e),n&&(n.style.display="none")})}else console.error("CSRF Token não encontrado.");else console.error("ID não encontrado no botão:",t)}else console.error("Botão não encontrado para o elemento clicado:",e.target)}e&&t&&e.addEventListener("click",()=>{var e=new FormData(t);a&&(a.style.display="block"),fetch("/admin/upload-edital",{headers:{"X-Requested-With":"XMLHttpRequest","X-CSRF-TOKEN":n},method:"POST",body:e}).then(e=>{if(e.ok)return e.json();throw new Error("Erro na requisição: "+e.status)}).then(e=>{document.getElementById("uploadStatus").textContent=e.message,a&&(a.style.display="none"),e.success&&loadEditais()}).catch(e=>{console.error("Erro ao fazer upload:",e),a&&(a.style.display="none"),document.getElementById("uploadStatus").textContent="Erro ao fazer upload."})}),document.querySelectorAll(".approve-btn, .reject-btn").forEach(e=>{e.removeEventListener("click",o),e.addEventListener("click",o)})}function loadEditais(e=1){let n=document.getElementById("loading");n&&(n.style.display="block"),fetch("/admin/listar-editais?pagina="+e,{headers:{"X-Requested-With":"XMLHttpRequest"}}).then(e=>{if(e.ok)return e.json();throw new Error("Erro na requisição: "+e.status)}).then(e=>{let a=document.getElementById("edital-list");var t=document.getElementById("no-editais");n&&(n.style.display="none"),a?(a.innerHTML="",e.editais&&0!==e.editais.length?(t&&(t.style.display="none"),e.editais.forEach(e=>{var t=document.createElement("tr");t.setAttribute("data-id",e.id),t.innerHTML=`
                <td>${e.name||"-"}</td>
                <td>${e.filename||"-"}</td>
                <td>${new Date(e.data_upload).toLocaleString("pt-BR")}</td>
                <td>${e.status||"em_analise"}</td>
                <td>
                    <button class="approve-btn" data-id="${e.id}"><i class="bi bi-check-circle"></i></button>
                    <button class="reject-btn" data-id="${e.id}"><i class="bi bi-x-circle-fill"></i></button>
                </td>
            `,a.appendChild(t)}),document.querySelector(".total-count").textContent=`Total: ${e.totalEditais} editais`,updatePagination(e.paginaAtual,e.totalPaginas),initializeEditalEvents()):(a.innerHTML='<tr><td colspan="5">Nenhum edital encontrado.</td></tr>',t&&(t.style.display="block"))):console.error("Elemento edital-list não encontrado")}).catch(e=>{console.error("Erro ao carregar editais:",e),n&&(n.style.display="none")})}function updatePagination(a,e){var t,n=document.querySelector(".pagination-netflix");if(n){n.innerHTML="",1<a&&((t=document.createElement("a")).href="#pagina="+(a-1),t.className="pagination-btn",t.textContent="Anterior",t.addEventListener("click",e=>{e.preventDefault(),loadEditais(a-1)}),n.appendChild(t));for(let t=1;t<=e;t++){var o=document.createElement("a");o.href="#pagina="+t,o.className="pagination-btn "+(t===a?"active":""),o.textContent=t,o.addEventListener("click",e=>{e.preventDefault(),loadEditais(t)}),n.appendChild(o)}a<e&&((t=document.createElement("a")).href="#pagina="+(a+1),t.className="pagination-btn",t.textContent="Próximo",t.addEventListener("click",e=>{e.preventDefault(),loadEditais(a+1)}),n.appendChild(t))}}initializeEditalEvents(),loadEditais(1);