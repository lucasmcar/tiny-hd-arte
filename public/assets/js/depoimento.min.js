function initializeDepoimentoEvents(){let t=document.getElementById("loading"),n=document.querySelector('input[name="_csrf_token"]')?.value;function o(e){e.preventDefault();e=e.target.closest(".delete-btn").getAttribute("data-id");confirm("Tem certeza que deseja excluir este depoimento?")&&(t&&(t.style.display="block"),fetch("/admin/excluir/depoimento/"+e,{method:"DELETE",headers:{"X-Requested-With":"XMLHttpRequest","X-CSRF-TOKEN":n}}).then(e=>{if(e.ok)return e.json();throw new Error("Erro na requisição: "+e.status)}).then(e=>{t&&(t.style.display="none"),e.success?loadDepoimentos():alert("Erro ao excluir depoimento: "+e.message)}).catch(e=>{console.error("Erro ao excluir depoimento:",e),t&&(t.style.display="none"),alert("Erro ao excluir depoimento.")}))}document.querySelectorAll(".delete-btn").forEach(e=>{e.removeEventListener("click",o),e.addEventListener("click",o)})}function loadDepoimentos(e=1){let o=document.getElementById("loading");o&&(o.style.display="block"),fetch("/admin/listar-depoimentos?pagina="+e,{headers:{"X-Requested-With":"XMLHttpRequest"}}).then(t=>t.ok?t.json():t.text().then(e=>{throw console.error("Resposta bruta do servidor:",e),new Error("Erro na requisição: "+t.status+" - "+e)})).then(e=>{let n=document.getElementById("depoimento-list");var t=document.getElementById("no-depoimentos");o&&(o.style.display="none"),n?(n.innerHTML="",e.depoimentos&&0!==e.depoimentos.length?(t&&(t.style.display="none"),e.depoimentos.forEach(e=>{var t=document.createElement("tr");t.setAttribute("data-id",e.id),t.innerHTML=`
                <td><img src="${e.foto}" width="64" height="64" class="rounded-circle"></td>
                <td>${e.nome}</td>
                <td>${e.titulo}</td>
                <td>${e.depoimento}</td>
                <td>
                    <a href="#" class="action-btn delete-btn" data-id="${e.id}"><i class="bi bi-trash"></i> Excluir</a>
                </td>
            `,n.appendChild(t)}),document.querySelector(".total-count").textContent=`Total: ${e.totalDepoimentos} depoimentos`,updatePagination(e.paginaAtual,e.totalPaginas),initializeDepoimentoEvents()):(n.innerHTML='<tr><td colspan="5">Nenhum depoimento encontrado.</td></tr>',t&&(t.style.display="block"))):console.error("Elemento depoimento-list não encontrado")}).catch(e=>{console.error("Erro ao carregar depoimentos:",e),o&&(o.style.display="none")})}function updatePagination(n,e){var t,o=document.querySelector(".pagination-netflix");if(o){if(o.innerHTML="",!(e<=1)){1<n&&((t=document.createElement("a")).href="#pagina="+(n-1),t.className="pagination-btn",t.textContent="Anterior",t.addEventListener("click",e=>{e.preventDefault(),loadDepoimentos(n-1)}),o.appendChild(t));for(let t=1;t<=e;t++){var i=document.createElement("a");i.href="#pagina="+t,i.className="pagination-btn "+(t===n?"active":""),i.textContent=t,i.addEventListener("click",e=>{e.preventDefault(),loadDepoimentos(t)}),o.appendChild(i)}n<e&&((t=document.createElement("a")).href="#pagina="+(n+1),t.className="pagination-btn",t.textContent="Próximo",t.addEventListener("click",e=>{e.preventDefault(),loadDepoimentos(n+1)}),o.appendChild(t))}}else console.error("Elemento .pagination-netflix não encontrado")}document.addEventListener("DOMContentLoaded",()=>{var e;window.location.pathname.includes("/admin/todos/depoimentos")&&(e=new URLSearchParams(window.location.search),e=parseInt(e.get("pagina"))||1,initializeDepoimentoEvents(),loadDepoimentos(e))});