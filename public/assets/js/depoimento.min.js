function initializeDepoimentoEvents(){console.log("Inicializando eventos de depoimentos");let t=document.getElementById("loading"),o=document.querySelector('input[name="_csrf_token"]')?.value;function n(e){e.preventDefault();e=e.target.closest(".delete-btn").getAttribute("data-id");confirm("Tem certeza que deseja excluir este depoimento?")&&(t&&(t.style.display="block"),fetch("/admin/excluir/depoimento/"+e,{method:"DELETE",headers:{"X-Requested-With":"XMLHttpRequest","X-CSRF-TOKEN":o}}).then(e=>{if(e.ok)return e.json();throw new Error("Erro na requisição: "+e.status)}).then(e=>{t&&(t.style.display="none"),e.success?(console.log("Depoimento excluído com sucesso, recarregando depoimentos"),loadDepoimentos()):alert("Erro ao excluir depoimento: "+e.message)}).catch(e=>{console.error("Erro ao excluir depoimento:",e),t&&(t.style.display="none"),alert("Erro ao excluir depoimento.")}))}document.querySelectorAll(".delete-btn").forEach(e=>{e.removeEventListener("click",n),e.addEventListener("click",n)})}function loadDepoimentos(e=1){console.log("Carregando depoimentos, página:",e);let n=document.getElementById("loading");n&&(n.style.display="block"),fetch("/admin/listar-depoimentos?pagina="+e,{headers:{"X-Requested-With":"XMLHttpRequest"}}).then(t=>t.ok?t.json():t.text().then(e=>{throw console.error("Resposta bruta do servidor:",e),new Error("Erro na requisição: "+t.status+" - "+e)})).then(e=>{let o=document.getElementById("depoimento-list");var t=document.getElementById("no-depoimentos");n&&(n.style.display="none"),o?(o.innerHTML="",e.depoimentos&&0!==e.depoimentos.length?(t&&(t.style.display="none"),e.depoimentos.forEach(e=>{var t=document.createElement("tr");t.setAttribute("data-id",e.id),t.innerHTML=`
                <td><img src="${e.foto}" width="64" height="64" class="rounded-circle"></td>
                <td>${e.nome}</td>
                <td>${e.titulo}</td>
                <td>${e.depoimento}</td>
                <td>
                    <a href="#" class="action-btn delete-btn" data-id="${e.id}"><i class="bi bi-trash"></i> Excluir</a>
                </td>
            `,o.appendChild(t)}),document.querySelector(".total-count").textContent=`Total: ${e.totalDepoimentos} depoimentos`,updatePagination(e.paginaAtual,e.totalPaginas),initializeDepoimentoEvents()):(o.innerHTML='<tr><td colspan="5">Nenhum depoimento encontrado.</td></tr>',t&&(t.style.display="block"))):console.error("Elemento depoimento-list não encontrado")}).catch(e=>{console.error("Erro ao carregar depoimentos:",e),n&&(n.style.display="none")})}function updatePagination(o,e){var t,n=document.querySelector(".pagination-netflix");if(n){if(n.innerHTML="",!(e<=1)){1<o&&((t=document.createElement("a")).href="#pagina="+(o-1),t.className="pagination-btn",t.textContent="Anterior",t.addEventListener("click",e=>{e.preventDefault(),loadDepoimentos(o-1)}),n.appendChild(t));for(let t=1;t<=e;t++){var a=document.createElement("a");a.href="#pagina="+t,a.className="pagination-btn "+(t===o?"active":""),a.textContent=t,a.addEventListener("click",e=>{e.preventDefault(),loadDepoimentos(t)}),n.appendChild(a)}o<e&&((t=document.createElement("a")).href="#pagina="+(o+1),t.className="pagination-btn",t.textContent="Próximo",t.addEventListener("click",e=>{e.preventDefault(),loadDepoimentos(o+1)}),n.appendChild(t))}}else console.error("Elemento .pagination-netflix não encontrado")}console.log("depoimentos.js carregado"),document.addEventListener("DOMContentLoaded",()=>{var e;console.log("Evento DOMContentLoaded disparado em depoimentos.js"),window.location.pathname.includes("/admin/todos/depoimentos")&&(e=new URLSearchParams(window.location.search),e=parseInt(e.get("pagina"))||1,initializeDepoimentoEvents(),loadDepoimentos(e))});