function initializeLogEvents(){var e=document.getElementById("log-filter"),e=(e?(e.removeEventListener("input",handleFilterInput),e.addEventListener("input",handleFilterInput)):console.error("Campo log-filter não encontrado"),document.getElementById("selectAll")),e=(e?(e.removeEventListener("change",handleSelectAll),e.addEventListener("change",handleSelectAll)):console.error("Checkbox selectAll não encontrado"),document.getElementById("exportPdf")),e=(e&&(e.removeEventListener("click",handleExportPdf),e.addEventListener("click",handleExportPdf)),document.getElementById("clearLogs"));e&&(e.removeEventListener("click",handleClearLogs),e.addEventListener("click",handleClearLogs))}function handleFilterInput(){loadLogs(this.value.toLowerCase())}function handleSelectAll(){document.querySelectorAll(".log-checkbox").forEach(e=>{e.checked=this.checked})}function handleExportPdf(){var e=window.jspdf.jsPDF,e=new e;e.autoTable({html:".logs-table"}),e.save("logs.pdf")}function handleClearLogs(){var e=Array.from(document.querySelectorAll(".log-checkbox:checked")).map(e=>e.value);0===e.length?showStatus("Nenhum log selecionado."):fetch("/admin/clear-logs",{method:"POST",headers:{"Content-Type":"application/json","X-Requested-With":"XMLHttpRequest"},body:JSON.stringify({ids:e})}).then(e=>e.json()).then(e=>{e.success?(showStatus("Logs limpos com sucesso!"),loadLogs((e=document.getElementById("log-filter"))?e.value.toLowerCase():"")):showStatus("Erro ao limpar logs.")}).catch(e=>console.error("Erro ao limpar logs:",e))}function loadLogs(e=""){fetch("/admin/configuracoes/list-logs"+(e?"?filter="+encodeURIComponent(e):""),{headers:{"X-Requested-With":"XMLHttpRequest"}}).then(t=>t.ok?t.json():t.text().then(e=>{throw new Error(`Erro na requisição: ${t.status} - `+e)})).then(e=>{let l=document.getElementById("logs-tbody");var t=document.getElementById("no-logs");l?(l.innerHTML="",e.logs&&0!==e.logs.length?(t.style.display="none",e.logs.forEach(e=>{var t=e.detalhes?JSON.parse(e.detalhes):{},t=t.titulo||t.name||t.status_antigo||"-",o=e.data_acao||e.created_at||"N/A",n=document.createElement("tr");n.innerHTML=`
                <td><input type="checkbox" class="log-checkbox" value="${e.id}"></td>
                <td>${new Date(o).toLocaleString("pt-BR")}</td>
                <td>${e.acao||"-"}</td>
                <td>${e.tabela_afetada||"-"}</td>
                <td>${e.id_registro||"N/A"}</td>
                <td>${t}</td>
            `,l.appendChild(n)}),initializeLogEvents()):(l.innerHTML='<tr><td colspan="6">Nenhum log encontrado.</td></tr>',t.style.display="block")):console.error("Elemento logs-tbody não encontrado")}).catch(e=>console.error("Erro ao carregar logs:",e))}function showStatus(e){let t=document.getElementById("statusMessage");t?(t.textContent=e,setTimeout(()=>t.textContent="",3e3)):console.error("Elemento statusMessage não encontrado")}initializeLogEvents();