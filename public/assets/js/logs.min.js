function initializeLogEvents(){console.log("Inicializando eventos de logs");var e=document.getElementById("log-filter"),e=(e?(console.log("Campo de filtro encontrado"),e.removeEventListener("input",handleFilterInput),e.addEventListener("input",handleFilterInput)):console.error("Campo log-filter não encontrado"),document.getElementById("selectAll")),e=(e?(console.log("Checkbox selectAll encontrado"),e.removeEventListener("change",handleSelectAll),e.addEventListener("change",handleSelectAll)):console.error("Checkbox selectAll não encontrado"),document.getElementById("exportPdf")),e=(e&&(e.removeEventListener("click",handleExportPdf),e.addEventListener("click",handleExportPdf)),document.getElementById("clearLogs"));e&&(e.removeEventListener("click",handleClearLogs),e.addEventListener("click",handleClearLogs))}function handleFilterInput(){var e=this.value.toLowerCase();console.log("Filtro digitado:",e),loadLogs(e)}function handleSelectAll(){var e=document.querySelectorAll(".log-checkbox");console.log("Checkboxes encontrados:",e.length),e.forEach(e=>{e.checked=this.checked,console.log("Checkbox atualizado:",e.value,e.checked)})}function handleExportPdf(){console.log("Exportando PDF");var e=window.jspdf.jsPDF,e=new e;e.autoTable({html:".logs-table"}),e.save("logs.pdf")}function handleClearLogs(){var e=Array.from(document.querySelectorAll(".log-checkbox:checked")).map(e=>e.value);console.log("Logs selecionados para limpeza:",e),0===e.length?showStatus("Nenhum log selecionado."):fetch("/admin/clear-logs",{method:"POST",headers:{"Content-Type":"application/json","X-Requested-With":"XMLHttpRequest"},body:JSON.stringify({ids:e})}).then(e=>e.json()).then(e=>{e.success?(showStatus("Logs limpos com sucesso!"),loadLogs((e=document.getElementById("log-filter"))?e.value.toLowerCase():"")):showStatus("Erro ao limpar logs.")}).catch(e=>console.error("Erro ao limpar logs:",e))}function loadLogs(e=""){console.log("Carregando logs com filtro:",e),fetch("/admin/configuracoes/list-logs"+(e?"?filter="+encodeURIComponent(e):""),{headers:{"X-Requested-With":"XMLHttpRequest"}}).then(o=>(console.log("Status da resposta:",o.status),o.ok?o.json():o.text().then(e=>{throw new Error(`Erro na requisição: ${o.status} - `+e)}))).then(e=>{console.log("Dados recebidos:",e);let l=document.getElementById("logs-tbody");var o=document.getElementById("no-logs");l?(l.innerHTML="",e.logs&&0!==e.logs.length?(console.log("Renderizando",e.logs.length,"logs"),o.style.display="none",e.logs.forEach(e=>{var o=e.detalhes?JSON.parse(e.detalhes):{},o=o.titulo||o.name||o.status_antigo||"-",t=e.data_acao||e.created_at||"N/A",n=document.createElement("tr");n.innerHTML=`
                <td><input type="checkbox" class="log-checkbox" value="${e.id}"></td>
                <td>${new Date(t).toLocaleString("pt-BR")}</td>
                <td>${e.acao||"-"}</td>
                <td>${e.tabela_afetada||"-"}</td>
                <td>${e.id_registro||"N/A"}</td>
                <td>${o}</td>
            `,l.appendChild(n)}),console.log("Tabela atualizada, reiniciando eventos"),initializeLogEvents()):(console.log("Nenhum log encontrado"),l.innerHTML='<tr><td colspan="6">Nenhum log encontrado.</td></tr>',o.style.display="block")):console.error("Elemento logs-tbody não encontrado")}).catch(e=>console.error("Erro ao carregar logs:",e))}function showStatus(e){let o=document.getElementById("statusMessage");o?(o.textContent=e,setTimeout(()=>o.textContent="",3e3)):console.error("Elemento statusMessage não encontrado")}console.log("logs.js carregado"),initializeLogEvents();