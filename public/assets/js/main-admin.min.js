document.addEventListener("DOMContentLoaded",function(){var e=document.querySelector(".top-navbar");"/admin/login"===window.location.pathname&&(e.style.display="none"),document.getElementById("sidebar");let a=document.getElementById("main-content");document.getElementById("toggle-sidebar");let c=[],i=[];function o(){var e=document.getElementById("sidebar"),t=document.getElementById("main-content");e&&t?(e.classList.toggle("active"),t.classList.toggle("shifted")):console.error("Elementos do sidebar não encontrados durante toggle:",{sidebar:e,mainContent:t})}function l(){var e=document.getElementById("sidebar"),t=document.getElementById("main-content");e&&t&&e.classList.contains("active")&&(e.classList.remove("active"),t.classList.remove("shifted"))}function s(){var e=document.getElementById("toggle-sidebar"),t=document.getElementById("sidebar"),n=document.getElementById("main-content");e&&t&&n&&(e.removeEventListener("click",o),e.addEventListener("click",o))}function d(){document.querySelectorAll(".nav-link:not(.accordion-toggle)").forEach(e=>{e.removeEventListener("click",n),e.addEventListener("click",n)}),document.removeEventListener("click",r),document.addEventListener("click",r)}function u(){document.querySelectorAll(".accordion-toggle").forEach(e=>{e.removeEventListener("click",t),e.addEventListener("click",t)})}function t(e){e.preventDefault(),e.stopPropagation();let t=this.nextElementSibling;e=t.classList.contains("active");document.querySelectorAll(".accordion-menu").forEach(e=>{e!==t&&(e.classList.remove("active"),e.previousElementSibling.classList.remove("active"),e.style.maxHeight="0")}),e?(t.classList.remove("active"),this.classList.remove("active"),t.style.maxHeight="0"):(t.classList.add("active"),this.classList.add("active"),t.style.maxHeight=t.scrollHeight+"px")}function n(e){e.preventDefault();e=e.currentTarget.getAttribute("data-page");e&&(v("/admin/"+e),l())}function r(e){var t=e.target.closest("[data-url]");t&&(e.preventDefault(),v(t.getAttribute("data-url")),l())}let m=[],g=!1;function h(e,t){m.push({src:e,callback:t}),function n(){if(!g&&0!==m.length){g=!0;let{src:e,callback:t}=m.shift();var o;document.querySelector(`script[src="${e}"]`)?(t(),g=!1,n()):((o=document.createElement("script")).src=e,o.onload=()=>{t(),g=!1,n()},o.onerror=()=>{console.error("Erro ao carregar script: "+e),g=!1,n()},o.dataset.dynamic="true",document.body.appendChild(o))}}()}function v(r){document.getElementById("loading").style.display="block",fetch(r,{headers:{"X-Requested-With":"XMLHttpRequest"}}).then(e=>e.text()).then(n=>{var n=(new DOMParser).parseFromString(n,"text/html"),o=n.querySelector("main");if(o){a.innerHTML=o.innerHTML,s(),d(),u();o=Array.from(n.querySelectorAll('link[rel="stylesheet"]')).map(e=>e.getAttribute("href"));let e=Array.from(n.querySelectorAll("script[src]")).map(e=>e.getAttribute("src")),t=(document.querySelectorAll('link[data-dynamic="true"]').forEach(e=>{e.remove()}),document.querySelectorAll('script[data-dynamic="true"]').forEach(e=>{e.remove()}),o.forEach(e=>{return t=e,document.querySelector(`link[href="${t}"]`)?document.querySelector(`link[href="${t}"]`):((e=document.createElement("link")).rel="stylesheet",e.href=t,e.onload=()=>console.log("Estilo carregado: "+t),e.onerror=()=>console.error("Erro ao carregar estilo: "+t),e.dataset.dynamic="true",document.head.appendChild(e),e);var t}),()=>{e.includes("http://localhost:8000/assets/js/tiny-init.js")&&("function"==typeof window.initializeTinyMCEOnDynamicLoad?window.initializeTinyMCEOnDynamicLoad():setTimeout(t,100))});e.forEach(e=>h(e,t)),c=o,i=e,"/admin/dashboard"===r&&(l(),y())}document.getElementById("loading").style.display="none"}).catch(e=>{console.error("Erro ao carregar a página:",e),document.getElementById("loading").style.display="none"})}function y(){var e=document.querySelectorAll(".metric");0===e.length?console.warn("Nenhum elemento .metric encontrado no DOM."):e.forEach(e=>{let t=parseInt(e.getAttribute("data-value"),10),n=(e.textContent="0",0);var o=Math.abs(Math.floor(300/(t||1)));e.counter&&clearInterval(e.counter),e.counter=setInterval(()=>{n+=1,(e.textContent=n)>=t&&(e.textContent=t,clearInterval(e.counter))},o)})}function f(e){e.preventDefault();e=document.querySelector('input[name="_csrf_token"]')?.value;e?fetch("/admin/logout",{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":e,"X-Requested-With":"XMLHttpRequest"},body:JSON.stringify({_csrf_token:e})}).then(e=>{if(e.ok)return e.text();throw new Error("Erro HTTP: "+e.status)}).then(t=>{try{var e=JSON.parse(t);e.success?window.location.href="/admin/login":console.error("Erro no logout:",e.message)}catch(e){console.error("Resposta não é JSON válida:",t,e),window.location.href="/admin/login"}}).catch(e=>{console.error("Erro ao fazer logout:",e),window.location.href="/admin/login"}):console.error("Token CSRF não encontrado.")}s(),d(),u(),l();e=document.querySelector('a[href="/admin/logout"]');e&&(e.removeEventListener("click",f),e.addEventListener("click",f)),"/admin/dashboard"===window.location.pathname&&(l(),y());let E=!1;new MutationObserver(e=>{e.forEach(()=>{document.querySelector(".dashboard-grid")&&!E&&(E=!0,l(),y(),setTimeout(()=>{E=!1},2500))})}).observe(a,{childList:!0,subtree:!0})});